<div class="card tile-panel">
    <div class="card-header">
        <h4 style="display: contents;" class="card-title mb-0">Purchase-Order</h4>
        <button (click)="add()" class="btn btn-icon btn-tnx float-end"
            [ngClass]="{'btn-outline-success':access.canInsert, 'btn-outline-secondary':!access.canInsert}"
            title="{{access.canInsert ? 'Click here to add new record.' : 'You do not have add access of this page.'}}">
            <i class="fa fa-plus"></i>
        </button>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-lg-12">
                <form #SearchPurchaseForm="ngForm" novalidate>
                    <div class="row">
                        <div class="col-lg-3 col-md-6">
                            <div class="form-group mb-2">
                                <label for="inSearchVendorName" class="form-label">Vendor</label>
                                <div class="input-group">
                                    <select class="form-select shadow-sm"
                                        [(ngModel)]="purchaseOrderParameterModel.vendorId" id="inSearchVendorName"
                                        name="inSearchVendorName">
                                        <option value="0">Select Vendor</option>
                                        <option *ngFor="let vendor of vendors" [value]="vendor.id">{{ vendor.name }}
                                        </option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-3 mb-4">
                        <button class="btn btn-primary" (click)="search()"
                            [ngClass]="{'btn-outline-primary':!access.canView, 'btn-outline-secondary':!access.canView}"
                            title="{{!(!access.canView) ? 'Click here to search record.' : 'You do not have search access of this page.'}}">
                            Search
                        </button>
                        <button type="button" class="btn btn-outline-secondary"
                            (click)="reset()">Reset</button>
                    </div>
                </form>
            </div>
        </div>
        <div class="table-wrapper">
            <div class="table-scroll">
                <table class="table table-hover common-table-bordered main-table">
                    <thead>
                        <tr>
                            <th (click)="sort('VendorName')" class="sort-header text-start">
                                Vendor
                                <i class="fa" [ngClass]="{
                                    'fa-sort': (purchaseOrderParameterModel.sortExpression != 'VendorName'), 
                                    'fa-sort-asc': (purchaseOrderParameterModel.sortExpression == 'VendorName' && purchaseOrderParameterModel.sortDirection === 'asc'), 
                                    'fa-sort-desc': (purchaseOrderParameterModel.sortExpression == 'VendorName' && purchaseOrderParameterModel.sortDirection === 'desc')
                                }"></i>
                            </th>
                            <th (click)="sort('Description')" class="sort-header text-start">
                                Description
                                <i class="fa" [ngClass]="{
                                    'fa-sort': (purchaseOrderParameterModel.sortExpression != 'Description'), 
                                    'fa-sort-asc': (purchaseOrderParameterModel.sortExpression == 'Description' && purchaseOrderParameterModel.sortDirection === 'asc'), 
                                    'fa-sort-desc': (purchaseOrderParameterModel.sortExpression == 'Description' && purchaseOrderParameterModel.sortDirection === 'desc')
                                }"></i>
                            </th>
                            <th (click)="sort('TotalQuantity')" class="sort-header text-end">
                                Quantity
                                <i class="fa" [ngClass]="{
                                    'fa-sort': (purchaseOrderParameterModel.sortExpression != 'TotalQuantity'), 
                                    'fa-sort-asc': (purchaseOrderParameterModel.sortExpression == 'TotalQuantity' && purchaseOrderParameterModel.sortDirection === 'asc'), 
                                    'fa-sort-desc': (purchaseOrderParameterModel.sortExpression == 'TotalQuantity' && purchaseOrderParameterModel.sortDirection === 'desc')
                                }"></i>
                            </th>
                            <th (click)="sort('TotalAmount')" class="sort-header text-end">
                                Amount
                                <i class="fa" [ngClass]="{
                                    'fa-sort': (purchaseOrderParameterModel.sortExpression != 'TotalAmount'), 
                                    'fa-sort-asc': (purchaseOrderParameterModel.sortExpression == 'TotalAmount' && purchaseOrderParameterModel.sortDirection === 'asc'), 
                                    'fa-sort-desc': (purchaseOrderParameterModel.sortExpression == 'TotalAmount' && purchaseOrderParameterModel.sortDirection === 'desc')
                                }"></i>
                            </th>
                            <th (click)="sort('TotalDiscount')" class="sort-header text-end">
                                Discount
                                <i class="fa" [ngClass]="{
                                    'fa-sort': (purchaseOrderParameterModel.sortExpression != 'TotalDiscount'), 
                                    'fa-sort-asc': (purchaseOrderParameterModel.sortExpression == 'TotalDiscount' && purchaseOrderParameterModel.sortDirection === 'asc'), 
                                    'fa-sort-desc': (purchaseOrderParameterModel.sortExpression == 'TotalDiscount' && purchaseOrderParameterModel.sortDirection === 'desc')
                                }"></i>
                            </th>
                            <th (click)="sort('TotalTax')" class="sort-header text-end">
                                Tax
                                <i class="fa" [ngClass]="{
                                    'fa-sort': (purchaseOrderParameterModel.sortExpression != 'TotalTax'), 
                                    'fa-sort-asc': (purchaseOrderParameterModel.sortExpression == 'TotalTax' && purchaseOrderParameterModel.sortDirection === 'asc'), 
                                    'fa-sort-desc': (purchaseOrderParameterModel.sortExpression == 'TotalTax' && purchaseOrderParameterModel.sortDirection === 'desc')
                                }"></i>
                            </th>
                            <th (click)="sort('TotalFinalAmount')" class="sort-header text-end">
                                Final Amount
                                <i class="fa" [ngClass]="{
                                    'fa-sort': (purchaseOrderParameterModel.sortExpression != 'TotalFinalAmount'), 
                                    'fa-sort-asc': (purchaseOrderParameterModel.sortExpression == 'TotalFinalAmount' && purchaseOrderParameterModel.sortDirection === 'asc'), 
                                    'fa-sort-desc': (purchaseOrderParameterModel.sortExpression == 'TotalFinalAmount' && purchaseOrderParameterModel.sortDirection === 'desc')
                                }"></i>
                            </th>
                            <!-- <th (click)="sort('OrderQty')" class="sort-header text-end">Order Qty</th> -->
                            <th class="sort-header text-start" style="width: 100px;">Actions</th>
                        </tr>
                    </thead>

                    <tbody>
                        <tr *ngFor="let item of purchaseOrderGridModel?.orderInvoices;">
                            <td class="text-start">{{item.vendorName}}</td>
                            <td class="text-start">{{item.description}}</td>
                            <td class="text-end">{{item.totalQuantity | number: '1.2-2'}}</td>
                            <td class="text-end">{{item.totalAmount | number: '1.2-2'}}</td>
                            <td class="text-end">{{item.totalDiscount | number: '1.2-2'}}</td>
                            <td class="text-end">{{item.totalTax| number: '1.2-2'}}</td>
                            <td class="text-end">{{item.totalFinalAmount| number: '1.2-2'}}</td>
                            <td class="text-start">
                                <button class="btn btn-icon btn-tnx" (click)="edit(item.id)"
                                    [ngClass]="{'btn-outline-primary':access.canUpdate, 'btn-outline-secondary':!access.canUpdate}"
                                    title="{{access.canUpdate ? 'Click here to edit this record.' : 'You do not have edit access of this page.'}}">
                                    <i class="fa fa-pencil"></i>
                                </button>
                                <button class="btn btn-icon btn-tnx" (click)="delete(item.id)"
                                    [ngClass]="{'btn-outline-danger':access.canDelete, 'btn-outline-secondary':!access.canDelete}"
                                    title="{{access.canDelete ? 'Click here to delete this record.' : 'You do not have delete access of this page.'}}">
                                    <i class="fa fa-trash"></i>
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="card-footer text-body-secondary">
        <div class="float-start card-header-controls">
            <select [(ngModel)]="purchaseOrderParameterModel.pageSize" (change)="search()" class="form-select">
                <option value="5">5</option>
                <option value="10">10</option>
                <option value="20">20</option>
                <option value="30">30</option>
                <option value="40">40</option>
                <option value="50">50</option>
                <option value="100">100</option>
                <option value="200">200</option>
            </select>
        </div>
        <div class="float-start total-records">Total Record(s) <strong>{{purchaseOrderGridModel.totalRecords}}</strong>
        </div>
        <div class="float-end">
            <ngb-pagination [collectionSize]="purchaseOrderGridModel.totalRecords"
                [pageSize]="purchaseOrderParameterModel.pageSize" [(page)]="purchaseOrderParameterModel.pageIndex"
                [maxSize]="5" [rotate]="true" [ellipses]="false" [boundaryLinks]="true"
                (pageChange)="search()"></ngb-pagination>
        </div>
    </div>
</div>